---
# Pre Ansible configuration
- name: Pre Ansible
  hosts: all
  gather_facts: false
  become: yes
  roles:
    - role: galexrt.pre-ansible
  tags:
    - pre-ansible

# Hosts pre-deploy configuration
- name: Pre Deploy
  hosts: all
  become: yes
  roles:
    - role: galexrt.pre-deploy
    - role: galexrt.package_update
  tags:
    - pre-deploy

- name: Setup timezone and time sync
  hosts: all
  roles:
    - role: ypsman.timedatectl
      timedatectl_timeservers:
        - ntp1.hetzner.de
        - ntp2.hetzner.com
      timedatectl_timeservers_fallback:
        - ntp3.hetzner.net
        - 0.de.pool.ntp.org
      timedatectl_timezone: UTC

# kernel-modules and sysctl configuration
- name: Sysctl and kernel-modules configuration
  hosts: all
  become: yes
  roles:
    - role: galexrt.kernel-modules
    - role: galexrt.sysctl
  tags:
    - sysctl
